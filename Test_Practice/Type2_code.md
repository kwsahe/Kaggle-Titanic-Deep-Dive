ë¹…ë°ì´í„°ë¶„ì„ê¸°ì‚¬ ì‹¤ê¸° ì‹œí—˜ì—ì„œ ì‚¬ìš©í•˜ëŠ” `sklearn.metrics`ì˜ í•µì‹¬ í‰ê°€ì§€í‘œë“¤ì„ ì½”ë“œë¡œ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤. ì‹œí—˜ì¥ì—ì„œëŠ” ì´ ì½”ë“œë“¤ì„ ë³µì‚¬í•˜ê±°ë‚˜ ì™¸ì›Œì„œ ì‚¬ìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

-----

### âš¡ï¸ [Cheatsheet] í•„ìˆ˜ Import ëª¨ìŒ (ë³µë¶™ìš©)

```python
import numpy as np
from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, roc_auc_score
from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score
from sklearn.metrics import mean_squared_log_error # RMSLEìš©
from sklearn.metrics import confusion_matrix, classification_report
```

-----

### 1ï¸âƒ£ ë¶„ë¥˜ (Classification) í‰ê°€ì§€í‘œ

  * **ì£¼ì˜ 1:** `predict()` ê²°ê³¼ê°’(0, 1 í´ë˜ìŠ¤)ì„ ë„£ëŠ” ê²ƒê³¼ `predict_proba()` ê²°ê³¼ê°’(í™•ë¥ )ì„ ë„£ëŠ” ê²ƒì„ êµ¬ë¶„í•´ì•¼ í•©ë‹ˆë‹¤.
  * **ì£¼ì˜ 2:** ë‹¤ì¤‘ë¶„ë¥˜(3ê°œ ì´ìƒ í´ë˜ìŠ¤)ì—ì„œëŠ” `average='macro'` ì˜µì…˜ì´ í•„ìˆ˜ì…ë‹ˆë‹¤.

<!-- end list -->

```python
# ê°€ìƒì˜ ì •ë‹µ(y_true)ê³¼ ì˜ˆì¸¡ê°’(y_pred)
y_true = [0, 1, 1, 0, 1]
y_pred = [0, 1, 0, 0, 1]       # ëª¨ë¸.predict() ê²°ê³¼
y_prob = [0.1, 0.9, 0.4, 0.2, 0.8] # ëª¨ë¸.predict_proba()[:, 1] ê²°ê³¼

# 1. ì •í™•ë„ (Accuracy)
acc = accuracy_score(y_true, y_pred)

# 2. ì •ë°€ë„ (Precision) - ì–‘ì„±ì´ë¼ ì˜ˆì¸¡í•œ ê²ƒ ì¤‘ ì‹¤ì œ ì–‘ì„±
prec = precision_score(y_true, y_pred)

# 3. ì¬í˜„ìœ¨ (Recall) - ì‹¤ì œ ì–‘ì„± ì¤‘ ì–‘ì„±ì´ë¼ ì˜ˆì¸¡í•œ ê²ƒ
rec = recall_score(y_true, y_pred)

# 4. F1-Score (ì •ë°€ë„ì™€ ì¬í˜„ìœ¨ì˜ ì¡°í™”í‰ê· ) â˜… ìì£¼ ì¶œì œ
f1 = f1_score(y_true, y_pred)

# 5. ROC-AUC â˜… í™•ë¥ (Probability) ì‚¬ìš© í•„ìˆ˜!
auc = roc_auc_score(y_true, y_prob) 

print(f"ì •í™•ë„: {acc:.4f}, F1: {f1:.4f}, AUC: {auc:.4f}")

# ---------------------------------------------------------
# [ì‹¬í™”] ë‹¤ì¤‘ ë¶„ë¥˜ (Multi-class)ì¼ ë•Œ (ì˜ˆ: 0, 1, 2 ì˜ˆì¸¡)
# ë°˜ë“œì‹œ average='macro' (ë˜ëŠ” 'micro', 'weighted')ë¥¼ ì¨ì•¼ í•¨
# ---------------------------------------------------------
# f1_macro = f1_score(y_true_multi, y_pred_multi, average='macro')
# prec_macro = precision_score(y_true_multi, y_pred_multi, average='macro')
```

-----

### 2ï¸âƒ£ íšŒê·€ (Regression) í‰ê°€ì§€í‘œ

  * **ì£¼ì˜:** íšŒê·€ëŠ” ì˜¤ì°¨(Error)ì´ë¯€ë¡œ ê°’ì´ **ì‘ì„ìˆ˜ë¡** ì¢‹ì€ ëª¨ë¸ì…ë‹ˆë‹¤. (R2 Scoreë§Œ í´ìˆ˜ë¡ ì¢‹ìŒ)
  * **RMSE**ëŠ” ë³„ë„ í•¨ìˆ˜ê°€ ì—†ì–´ì„œ MSEì— ë£¨íŠ¸(`np.sqrt`)ë¥¼ ì”Œì›Œì•¼ í•©ë‹ˆë‹¤.

<!-- end list -->

```python
# ê°€ìƒì˜ ì •ë‹µ(y_true)ê³¼ ì˜ˆì¸¡ê°’(y_pred)
y_true = [100, 200, 300, 400]
y_pred = [110, 190, 320, 380]

# 1. MAE (Mean Absolute Error) - í‰ê·  ì ˆëŒ€ ì˜¤ì°¨
mae = mean_absolute_error(y_true, y_pred)

# 2. MSE (Mean Squared Error) - í‰ê·  ì œê³± ì˜¤ì°¨
mse = mean_squared_error(y_true, y_pred)

# 3. RMSE (Root Mean Squared Error) - MSEì— ë£¨íŠ¸ ì”Œì›€ â˜… ìì£¼ ì¶œì œ
# (ë°©ë²• A: ì •ì„)
rmse = np.sqrt(mse)
# (ë°©ë²• B: ìµœì‹  ë²„ì „ sklearn)
# rmse = mean_squared_error(y_true, y_pred, squared=False) 

# 4. R2 Score (ê²°ì •ê³„ìˆ˜) - 1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì¢‹ìŒ
r2 = r2_score(y_true, y_pred)

# 5. RMSLE (Root Mean Squared Log Error) - ë¡œê·¸ë³€í™˜ í›„ RMSE
# (ê°’ì˜ ë²”ìœ„ê°€ í¬ê±°ë‚˜, 0ì— ê°€ê¹Œìš´ ê°’ì´ ì¤‘ìš”í•  ë•Œ ì‚¬ìš©)
# ì£¼ì˜: ìŒìˆ˜ ê°’ì´ ìˆìœ¼ë©´ ì—ëŸ¬ë‚¨
msle = mean_squared_log_error(y_true, y_pred)
rmsle = np.sqrt(msle)

print(f"MAE: {mae:.2f}, RMSE: {rmse:.2f}, R2: {r2:.2f}")
```

-----

### ğŸ“ ì‹œí—˜ì¥ ê¿€íŒ (ì´ê²ƒë§Œì€ ê¼­\!)

1.  **ROC-AUCëŠ” ë¬´ì¡°ê±´ `predict_proba`**:

      * `model.predict(X_test)` â¡ï¸ (X) ì—ëŸ¬ëŠ” ì•ˆ ë‚˜ì§€ë§Œ ì ìˆ˜ê°€ ë‚®ê²Œ ë‚˜ì˜´.
      * `model.predict_proba(X_test)[:, 1]` â¡ï¸ (O) 1ì¼ í™•ë¥ ì„ ë„£ì–´ì•¼ í•¨.

2.  **ë‹¤ì¤‘ ë¶„ë¥˜ F1-ScoreëŠ” `average='macro'`**:

      * ì‹œí—˜ ë¬¸ì œì—ì„œ "í‰ê°€ì§€í‘œ: Macro F1"ì´ë¼ê³  ëª…ì‹œë˜ë©´ `f1_score(..., average='macro')`ë¥¼ ì•ˆ ì“°ë©´ ì—ëŸ¬ê°€ ë‚©ë‹ˆë‹¤.

3.  **RMSE ê³„ì‚°**:

      * `sklearn` ë²„ì „ì— ë”°ë¼ `squared=False` ì˜µì…˜ì´ ì•ˆ ë¨¹í ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
      * ì•ˆì „í•˜ê²Œ **`np.sqrt(mean_squared_error(y, pred))`** ë°©ì‹ì„ ì™¸ìš°ëŠ” ê²Œ ì¢‹ìŠµë‹ˆë‹¤.

      `[:, 1]`ì€ íŒŒì´ì¬(NumPy)ì—ì„œ \*\*"2ì°¨ì› í‘œ(í–‰ë ¬)ë¥¼ ìë¥´ëŠ” ë¬¸ë²•(Slicing)"\*\*ì…ë‹ˆë‹¤.

í•œë§ˆë””ë¡œ ì •ì˜í•˜ë©´: \*\*"ëª¨ë“  ì¤„(í–‰)ì„ ë‹¤ ê°€ì ¸ì˜¤ë˜, ë‘ ë²ˆì§¸ ì¹¸(ì—´)ë§Œ ë½‘ì•„ë¼"\*\*ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤.

-----

### ğŸ” í•´ë¶€í•™ì  ë¶„ì„

`[ : , 1 ]`

1.  **`:` (ì½œë¡ )**

      * **ì˜ë¯¸:** "ì²˜ìŒë¶€í„° ëê¹Œì§€ ì „ë¶€ ë‹¤"
      * **ìœ„ì¹˜:** ì‰¼í‘œ ì•(í–‰ ìë¦¬)ì— ìˆìœ¼ë¯€ë¡œ \*\*"ëª¨ë“  ì‚¬ëŒ(ë°ì´í„°)ì„ ë‹¤ ì„ íƒí•´ë¼"\*\*ëŠ” ëœ»ì…ë‹ˆë‹¤.

2.  **`,` (ì‰¼í‘œ)**

      * **ì˜ë¯¸:** í–‰(ê°€ë¡œ)ê³¼ ì—´(ì„¸ë¡œ)ì„ ë‚˜ëˆ„ëŠ” ê¸°ì¤€ì„ ì…ë‹ˆë‹¤.

3.  **`1` (ìˆ«ì 1)**

      * **ì˜ë¯¸:** **"ì¸ë±ìŠ¤ 1ë²ˆ ì»¬ëŸ¼"** (ì¦‰, ë‘ ë²ˆì§¸ ì»¬ëŸ¼)
      * íŒŒì´ì¬ì€ ìˆ«ìë¥¼ 0ë¶€í„° ì…‰ë‹ˆë‹¤.
          * `0`ë²ˆ ì»¬ëŸ¼: ì²« ë²ˆì§¸ (Class 0, ì‹¤íŒ¨/ì‚¬ë§ í™•ë¥ )
          * `1`ë²ˆ ì»¬ëŸ¼: ë‘ ë²ˆì§¸ (Class 1, ì„±ê³µ/ìƒì¡´ í™•ë¥ )

-----

### ğŸ’¡ ê·¸ë¦¼ìœ¼ë¡œ ì´í•´í•˜ê¸° (`predict_proba`ì˜ ê²°ê³¼ë¬¼)

ëª¨ë¸ì´ `predict_proba(X)`ë¥¼ ì‹¤í–‰í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ **2ì¤„ì§œë¦¬ í‘œ**ë¥¼ ë±‰ì–´ëƒ…ë‹ˆë‹¤.

| (ì¸ë±ìŠ¤) | **[0]ë²ˆ ì»¬ëŸ¼**<br>(ì•ˆ ì‚´ í™•ë¥ ) | **[1]ë²ˆ ì»¬ëŸ¼**<br>(ì‚´ í™•ë¥ ) |
| :--- | :--- | :--- |
| ê³ ê° A | 0.8 (ì•ˆ ì‚¼) | **0.2** (ì‚¼) |
| ê³ ê° B | 0.1 (ì•ˆ ì‚¼) | **0.9** (ì‚¼) |
| ê³ ê° C | 0.4 (ì•ˆ ì‚¼) | **0.6** (ì‚¼) |

ì—¬ê¸°ì„œ ìš°ë¦¬ëŠ” \*\*"ì‚´ í™•ë¥ (Class 1)"\*\*ë§Œ í•„ìš”í•©ë‹ˆë‹¤.

  * `predict_proba(X)` ì „ì²´ â†’ í‘œ ì „ì²´ë¥¼ ê°€ì ¸ì˜´ (0.8, 0.2 ë‘˜ ë‹¤)
  * `predict_proba(X)[:, 0]` â†’ `[0.8, 0.1, 0.4]` (ì•ˆ ì‚´ í™•ë¥ ë§Œ ë½‘ìŒ)
  * **`predict_proba(X)[:, 1]`** â†’ **`[0.2, 0.9, 0.6]` (ì‚´ í™•ë¥ ë§Œ ë½‘ìŒ)** âœ… **(ì •ë‹µ\!)**

-----

### ğŸš€ ìš”ì•½

ì‹œí—˜ì—ì„œ **ROC-AUC**ë‚˜ **í™•ë¥  ì œì¶œ** ë¬¸ì œê°€ ë‚˜ì˜¤ë©´, ìš°ë¦¬ëŠ” \*\*"ì •ë‹µ(1)ì¼ í™•ë¥ "\*\*ì´ í•„ìš”í•©ë‹ˆë‹¤.

ê·¸ë˜ì„œ ë¬´ì¡°ê±´ ê¸°ê³„ì ìœ¼ë¡œ \*\*`[:, 1]`\*\*ì„ ë¶™ì—¬ì„œ \*\*ì˜¤ë¥¸ìª½ ì¤„(Class 1)\*\*ë§Œ ì™ ë¹¼ì˜¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

```python
# ëª¨ë¸ì´ ë±‰ì€ ì „ì²´ í™•ë¥  (2ê°œ ì»¬ëŸ¼)
full_prob = [[0.9, 0.1], 
             [0.2, 0.8]]

# [:, 1]ì„ í•˜ë©´? -> ë’¤ì— ìˆëŠ” 0.1, 0.8ë§Œ ê°€ì ¸ì˜´!
final_prob = [0.1, 0.8] 
```